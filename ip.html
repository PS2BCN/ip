<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultor Fiscal Patrimonio 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .active-tab { border-bottom: 3px solid #0f172a; color: #0f172a; font-weight: bold; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen font-sans">

    <div class="max-w-5xl mx-auto py-10 px-4">
        <header class="bg-slate-900 text-white p-6 rounded-t-xl shadow-lg">
            <h1 class="text-2xl font-bold">Consultor Fiscal de Patrimonio 2026</h1>
            <p class="text-slate-400 text-sm">Motor de Liquidación Comparativa Interterritorial</p>
        </header>

        <div class="bg-white border-b flex overflow-x-auto">
            <button onclick="showTab('simulador')" id="tab-btn-simulador" class="px-6 py-4 text-slate-500 hover:bg-slate-50 active-tab whitespace-nowrap">Simulador de Cálculo</button>
            <button onclick="showTab('tablas')" id="tab-btn-tablas" class="px-6 py-4 text-slate-500 hover:bg-slate-50 whitespace-nowrap">Tablas y Porcentajes</button>
        </div>

        <main class="bg-white p-6 rounded-b-xl shadow-lg">
            
            <div id="simulador" class="tab-content active">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-slate-50 p-6 rounded-lg border border-slate-200">
                        <h2 class="text-sm font-bold text-slate-500 mb-6 uppercase tracking-wider">Datos del Contribuyente</h2>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-xs font-semibold text-slate-600 mb-1">Comunidad de Residencia</label>
                                <select id="ccaa" class="w-full border p-2 rounded bg-white shadow-sm focus:ring-2 focus:ring-slate-400 outline-none">
                                    <option value="Cataluña">Cataluña</option>
                                    <option value="Madrid">Madrid</option>
                                    <option value="Andalucía">Andalucía</option>
                                    <option value="C. Valenciana">C. Valenciana</option>
                                    <option value="Aragón">Aragón</option>
                                    <option value="Resto España">Resto España</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-xs font-semibold text-slate-600 mb-1">Vivienda Habitual (€)</label>
                                <input type="number" id="viv" placeholder="0" class="w-full border p-2 rounded shadow-sm">
                            </div>

                            <div>
                                <label class="block text-xs font-semibold text-slate-600 mb-1">Otros Bienes y Derechos (€)</label>
                                <input type="number" id="bien" placeholder="0" class="w-full border p-2 rounded shadow-sm">
                            </div>

                            <div>
                                <label class="block text-xs font-semibold text-slate-600 mb-1">Deudas Deducibles (€)</label>
                                <input type="number" id="deu" placeholder="0" class="w-full border p-2 rounded shadow-sm">
                            </div>

                            <button onclick="ejecutar()" class="w-full bg-slate-900 text-white font-bold py-3 rounded-lg hover:bg-slate-800 transition-all shadow-md mt-4">
                                GENERAR LIQUIDACIÓN
                            </button>
                        </div>
                    </div>

                    <div class="flex flex-col">
                        <h2 class="text-sm font-bold text-slate-500 mb-2 uppercase tracking-wider text-right">Informe Resultante</h2>
                        <div class="bg-slate-900 rounded-lg p-6 shadow-inner flex-grow overflow-auto">
                            <pre id="txt_res" class="text-xs font-mono text-green-400 whitespace-pre">Esperando datos para procesar...</pre>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tablas" class="tab-content">
                <div class="overflow-x-auto">
                    <pre id="info-tablas" class="text-xs font-mono text-slate-700 bg-slate-50 p-6 rounded border"></pre>
                </div>
            </div>

        </main>
    </div>

    <script>
        // CONFIGURACIÓN FISCAL 2026
        const ccaa_config = {
            "Cataluña": [500000, "catalana", 1.0],
            "Madrid": [700000, "estatal", 0.0],
            "Andalucía": [700000, "estatal", 0.0],
            "C. Valenciana": [500000, "estatal", 1.0],
            "Aragón": [400000, "estatal", 1.0],
            "Resto España": [700000, "estatal", 1.0]
        };

        const escalas = {
            "estatal": [[167129, 0.002], [334252, 0.003], [668499, 0.005], [1336999, 0.009], [2673999, 0.013], [5347998, 0.017], [10695996, 0.021], [Infinity, 0.035]],
            "catalana": [[167129, 0.0021], [334252, 0.00315], [668499, 0.00525], [1336999, 0.00945], [2673999, 0.01365], [5347998, 0.01785], [10695996, 0.0236], [Infinity, 0.0275]]
        };

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('button[id^="tab-btn-"]').forEach(b => b.classList.remove('active
